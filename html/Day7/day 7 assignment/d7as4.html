<!DOCTYPE html>
<html>
<head>
  <title>User Data Form with Username</title>
</head>
<body>

<h2>Enter User Data</h2>
<form id="userForm" onsubmit="return handleSubmit(event)">
  First Name: <input type="text" id="firstName" required><br><br>
  Last Name: <input type="text" id="lastName" required><br><br>
  Age: <input type="number" id="age" required><br><br>
  <button type="submit">Submit</button>
</form>

<h3>Stored User Data</h3>
<table border="1" id="dataTable" style="border-collapse: collapse; width: 60%;">
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Age</th>
      <th>Username</th>
    </tr>
  </thead>
  <tbody id="tableBody">
  </tbody>
</table>

<script>
  function handleSubmit(e) {
    e.preventDefault();

    var form = document.getElementById("userForm");
    var tbody = document.getElementById("tableBody");

    // Get input values
    var firstName = document.getElementById("firstName").value.trim();
    var lastName = document.getElementById("lastName").value.trim();
    var age = document.getElementById("age").value.trim();

    // Create user object with username
    function createUserObj(fName, lName, ageVal) {
      // Extract username parts safely
      var firstPart = fName.substring(0, 2).toLowerCase();
      var lastPart = lName.length >= 2 ? lName.substring(lName.length - 2).toLowerCase() : lName.toLowerCase();

      var username = firstPart + lastPart + ageVal;

      return {
        firstName: fName,
        lastName: lName,
        age: Number(ageVal),
        username: username
      };
    }

    var userObj = createUserObj(firstName, lastName, age);

    // Convert to JSON and parse back
    var userJSON = JSON.stringify(userObj);
    var userFromJSON = JSON.parse(userJSON);

    // Create table row and cells
    var row = document.createElement("tr");

    var cell1 = document.createElement("td");
    cell1.textContent = userFromJSON.firstName;

    var cell2 = document.createElement("td");
    cell2.textContent = userFromJSON.lastName;

    var cell3 = document.createElement("td");
    cell3.textContent = userFromJSON.age;

    var cell4 = document.createElement("td");
    cell4.textContent = userFromJSON.username;

    row.appendChild(cell1);
    row.appendChild(cell2);
    row.appendChild(cell3);
    row.appendChild(cell4);

    tbody.appendChild(row);

    // Clear form
    form.reset();

    return false;
  }
</script>

</body>
</html>
